// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE

import * as Css from "bs-css/src/Css.js";
import * as List from "bs-platform/lib/es6/list.js";
import * as $$Array from "bs-platform/lib/es6/array.js";
import * as Block from "bs-platform/lib/es6/block.js";
import * as Curry from "bs-platform/lib/es6/curry.js";
import * as React from "react";
import * as ReactUpdate from "reason-react-update/src/ReactUpdate.bs.js";
import * as Types$ReasonImageGridExample from "./Types.bs.js";
import * as Utils$ReasonImageGridExample from "./Utils.bs.js";
import * as PhotoItem$ReasonImageGridExample from "./PhotoItem.bs.js";
import * as PhotoModal$ReasonImageGridExample from "./PhotoModal.bs.js";

var container = Css.style(/* :: */[
      Css.height(/* `percent */[
            -119887163,
            100.0
          ]),
      /* :: */[
        Css.width(/* `percent */[
              -119887163,
              100.0
            ]),
        /* :: */[
          Css.display(/* flex */-1010954439),
          /* :: */[
            Css.justifyContent(/* center */98248149),
            /* [] */0
          ]
        ]
      ]
    ]);

var photoContainer = Css.style(/* :: */[
      Css.display(/* flex */-1010954439),
      /* :: */[
        Css.flexWrap(/* wrap */-822134326),
        /* :: */[
          Css.maxWidth(/* `px */[
                25096,
                1000
              ]),
          /* [] */0
        ]
      ]
    ]);

var Styles = {
  container: container,
  photoContainer: photoContainer
};

function getPhotos(param) {
  return Utils$ReasonImageGridExample.fetchAndDecode("https://jsonplaceholder.typicode.com/photos", Types$ReasonImageGridExample.photos_decode);
}

var API = {
  getPhotos: getPhotos
};

function PhotoContainer(Props) {
  var match = ReactUpdate.useReducer({
        visualState: /* Loading */0
      }, (function (action, state) {
          if (typeof action === "number") {
            return /* UpdateWithSideEffects */Block.__(1, [
                      state,
                      (function (param) {
                          var send = param.send;
                          Curry._2(Utils$ReasonImageGridExample.$$Promise.let_, Utils$ReasonImageGridExample.fetchAndDecode("https://jsonplaceholder.typicode.com/photos", Types$ReasonImageGridExample.photos_decode), (function (photos) {
                                  var filteredPhotos = List.filter((function (photo) {
                                            return photo.id < 26;
                                          }))(photos);
                                  return Curry._1(Utils$ReasonImageGridExample.$$Promise.resolved, Curry._1(send, /* SetVisualState */Block.__(2, [/* Loaded */Block.__(0, [filteredPhotos])])));
                                }));
                          return ;
                        })
                    ]);
          } else {
            switch (action.tag | 0) {
              case /* SetModalOpen */0 :
                  return /* Update */Block.__(0, [{
                              visualState: /* Modal */Block.__(2, [
                                  action[0],
                                  action[1]
                                ])
                            }]);
              case /* SetModalClosed */1 :
                  return /* Update */Block.__(0, [{
                              visualState: /* Loaded */Block.__(0, [action[0]])
                            }]);
              case /* SetVisualState */2 :
                  return /* Update */Block.__(0, [{
                              visualState: action[0]
                            }]);
              case /* SetItemToLocalStorage */3 :
                  var id = action[1];
                  var string = action[0];
                  return /* UpdateWithSideEffects */Block.__(1, [
                            state,
                            (function (param) {
                                localStorage.setItem("image" + id, string);
                                return ;
                              })
                          ]);
              
            }
          }
        }));
  var send = match[1];
  React.useEffect((function () {
          Curry._1(send, /* FetchPhotos */0);
          return ;
        }), ([]));
  var match$1 = match[0].visualState;
  if (typeof match$1 === "number") {
    return React.createElement("h1", undefined, "...Loading");
  } else {
    switch (match$1.tag | 0) {
      case /* Loaded */0 :
          var photos = match$1[0];
          return React.createElement("div", {
                      className: container
                    }, React.createElement("div", {
                          className: photoContainer
                        }, $$Array.of_list(List.map((function (item) {
                                    return React.createElement(PhotoItem$ReasonImageGridExample.make, {
                                                photo: item,
                                                photos: photos,
                                                setModalOpen: (function (photo, photos) {
                                                    return Curry._1(send, /* SetModalOpen */Block.__(0, [
                                                                  photo,
                                                                  photos
                                                                ]));
                                                  }),
                                                key: String(item.id)
                                              });
                                  }), photos))));
      case /* Error */1 :
          return React.createElement("h1", undefined, "Uh oh: " + match$1[0]);
      case /* Modal */2 :
          return React.createElement(PhotoModal$ReasonImageGridExample.make, {
                      photo: match$1[0],
                      photos: match$1[1],
                      setModalClosed: (function (photos) {
                          return Curry._1(send, /* SetModalClosed */Block.__(1, [photos]));
                        }),
                      onInputSubmit: (function (value, id) {
                          return Curry._1(send, /* SetItemToLocalStorage */Block.__(3, [
                                        value,
                                        id
                                      ]));
                        })
                    });
      
    }
  }
}

var make = PhotoContainer;

export {
  Styles ,
  API ,
  make ,
  
}
/* container Not a pure module */
